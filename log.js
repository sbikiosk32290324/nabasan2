function multiply()
    {
	
	var final_data= document.getElementById("note1").value;
      var qnt=document.getElementById("Quantity1").value;
        var amt=final_data*qnt;
      document.getElementById("total1").value=amt;
	  var note2= document.getElementById("note2").value;
      var qnt2=document.getElementById("Quantity2").value;
        var amt2=note2*qnt2;
      document.getElementById("total2").value=amt2;
	  var note3= document.getElementById("note3").value;
      var qnt3=document.getElementById("Quantity3").value;
        var amt3=note3*qnt3;
      document.getElementById("total3").value=amt3;
	  var note4= document.getElementById("note4").value;
      var qnt4=document.getElementById("Quantity4").value;
        var amt4=note4*qnt4;
      document.getElementById("total4").value=amt4;
	  var note5= document.getElementById("note5").value;
      var qnt5=document.getElementById("Quantity5").value;
        var amt5=note5*qnt5;
      document.getElementById("total5").value=amt5;
	  
	  var note6= document.getElementById("note6").value;
      var qnt6=document.getElementById("Quantity6").value;
        var amt6=note6*qnt6;
      document.getElementById("total6").value=amt6;
	  
	  var note7= document.getElementById("note7").value;
      var qnt7=document.getElementById("Quantity7").value;
        var amt7=note7*qnt7;
      document.getElementById("total7").value=amt7;
	  
	  var note8= document.getElementById("note8").value;
      var qnt8=document.getElementById("Quantity8").value;
        var amt8=note8*qnt8;
      document.getElementById("total8").value=amt8;
	  
	  var note9= document.getElementById("note9").value;
      var qnt9=document.getElementById("Quantity9").value;
        var amt9=note9*qnt9;
      document.getElementById("total9").value=amt9;
	  
	  var note10= document.getElementById("note10").value;
      var qnt10=document.getElementById("Quantity10").value;
        var amt10=note10*qnt10;
      document.getElementById("total10").value=amt10;
	  
	  var note11= document.getElementById("note11").value;
      var qnt11=document.getElementById("Quantity11").value;
        var amt11=note11*qnt11;
      document.getElementById("total11").value=amt11;
	  
	  var note12= document.getElementById("note12").value;
      var qnt12=document.getElementById("Quantity12").value;
        var amt12=note12*qnt12;
      document.getElementById("total12").value=amt12;
	  
	  var note13= document.getElementById("note13").value;
      var qnt13=document.getElementById("Quantity13").value;
        var amt13=note13*qnt13;
      document.getElementById("total13").value=amt13;
	  
	  var note14= document.getElementById("note14").value;
      var qnt14=document.getElementById("Quantity14").value;
        var amt14=note14*qnt14;
      document.getElementById("total14").value=amt14;
	  
	  var note15= document.getElementById("note15").value;
      var qnt15=document.getElementById("Quantity15").value;
        var amt15=note15*qnt15;
      document.getElementById("total15").value=amt15;
	  
	  var note16= document.getElementById("note16").value;
      var qnt16=document.getElementById("Quantity16").value;
        var amt16=note16*qnt16;
      document.getElementById("total16").value=amt16;
	  
	  var note17= document.getElementById("anup").value;
	  var amt17=note17
	  document.getElementById("total17").value=amt17;
	  
	  var total1= document.getElementById("total1").value;
	  var total2= document.getElementById("total2").value;
	  var total3= document.getElementById("total3").value;
	  var total4= document.getElementById("total4").value;
	  var total5= document.getElementById("total5").value;
	  var total6= document.getElementById("total6").value;
	  var total7= document.getElementById("total7").value;
	  var total8= document.getElementById("total8").value;
	  var total9= document.getElementById("total9").value;
	  var total10= document.getElementById("total10").value;
	  var total11= document.getElementById("total11").value;
	  var total12= document.getElementById("total12").value;
	  var total13= document.getElementById("total13").value;
	  var total14= document.getElementById("total14").value;
	  var total15= document.getElementById("total15").value;
	  var total16= document.getElementById("total16").value;
	  var total17= document.getElementById("total17").value;
	  var total18= document.getElementById("total18").value;
	  var total19= document.getElementById("total19").value;
	  var total20= document.getElementById("total20").value;
	  var total21= document.getElementById("total21").value;
	  var total22= document.getElementById("total22").value;
	  var total23= document.getElementById("total23").value;
	  var total24= document.getElementById("total24").value;
	  var total25= document.getElementById("total25").value;
	  var total26= document.getElementById("total26").value;
	 
	  var all1=+(total1)+ +(total2)+ +(total3)+ +(total4)+ +(total5)+ +(total6)+ +(total7)+ +(total8)+  +(total9)+ +(total10)+ +(total11)+ +(total12)+ +(total13)+ +(total14)+ +(total15)+ +(total16)+ +(total17)+ +(total18)+ +(total19)+ +(total21)+ +(total22)+ +(total23)+ +(total24)+ +(total25);
	  document.getElementById("all_total").value=all1;
	  
	  var qt20=+(qnt2)+ +(qnt4)+ +(qnt6)+ +(qnt8)+ +(qnt10)+ +(qnt12);
	  document.getElementById("non").value=qt20;
	  
	  var amt20=+(total2)+ +(total4)+ +(total6)+ +(total8)+ +(total10)+ +(total12);
	  document.getElementById("total20").value=amt20;
	  
	  var note18= document.getElementById("dipika").value;
	  var amt18=note18
	  document.getElementById("total18").value=amt18;
	  
	  var note21= document.getElementById("bc").value;
	  var amt21=note21
	  document.getElementById("total21").value=amt21;
	  
	  var note22= document.getElementById("exc").value;
	  var amt22=note22
	  document.getElementById("total22").value=amt22;
	  
	  var note23= document.getElementById("ac").value;
	  var amt23=note23
	  document.getElementById("total23").value=amt23;
	  
	  var note24= document.getElementById("ofe").value;
	  var amt24=note24
	  document.getElementById("total24").value=amt24;
	  
	  var note25= document.getElementById("pc").value;
	  var amt25=note25
	  document.getElementById("total25").value=amt25;
	  
	  var note26= document.getElementById("ob").value;
	  var amt26=note26
	  document.getElementById("total26").value=amt26;
	 var amt27=total26
	  document.getElementById("total26_1").value=amt27;
	  
	  var note19= document.getElementById("loan").value;
	  var amt19=note19
	  document.getElementById("total19").value=amt19;
	  
	  var ato= document.getElementById("all_total").value;
	  var pob= document.getElementById("total26_1").value;
	  var mib=-(pob)- -(ato) 
	  document.getElementById("db").value=mib;
	  
	  
var dt = new Date();
document.getElementById("date").innerHTML = dt.toLocaleDateString();

var dt1 = new Date();
document.getElementById("time").innerHTML = dt1.toLocaleTimeString();


document.getElementById("Quantity1").max = "1000";
document.getElementById("Quantity2").max = "1000";
	    document.getElementById("Quantity3").max = "1000";
	    document.getElementById("Quantity4").max = "1000";
	    document.getElementById("Quantity5").max = "1000";
	    document.getElementById("Quantity6").max = "1000";
	    document.getElementById("Quantity7").max = "1000";
	    document.getElementById("Quantity8").max = "1000";
	    document.getElementById("Quantity9").max = "1000";
	    document.getElementById("Quantity10").max = "1000";
	    document.getElementById("Quantity11").max = "1000";
	    document.getElementById("Quantity12").max = "1000";
	    document.getElementById("Quantity13").max = "1000";
	    document.getElementById("Quantity14").max = "1000";
	    document.getElementById("Quantity15").max = "1000";
	    document.getElementById("Quantity16").max = "1000";
	    
	  }
	  
function GetPrint()
{
    /*For Print*/
    window.print();
}
function SetCurrentDate()
{
    const date = new Date();
    console.log(date);

    let d = date.getDate();
    let m = date.getMonth() + 1;
    let y = date.getFullYear();

    if (d < 10) d = '0' + d;
    if (m < 10) m = '0' + m;

    let CurrDate = y + '-' + m + '-' + d;

    $('input[name="inv_dt"]').val(CurrDate);

}


function getData() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = sheet.getDataRange().getValues();
  return JSON.stringify(data);

function Search(pNo="")
{
        var no = $('#inv_dt').val();

		if (pNo != "") no = pNo;

        $.getJSON("https://script.google.com/macros/s/AKfycbwY-UFbyCNcAswUy2uBRlxHUjNqUyDlLDA9fwKAOjO-34REUbn6egRmqBtKd4u3NogY/exec"+no,
        function (data) {

         
          //alert(data);
         // console.log(data);
          if (data == "NOT FOUND")
          {
            alert('Invoice No. Not Found...');

          }
          else
          {
            //var record = data;
            var record   = data.record;

            var StartRow = data.SR;
            var RowCount = data.CNT;

            $('#IsNew').val('N');
            $('#StartRow').val(StartRow);
            $('#RowCount').val(RowCount);
         
            var i = 0;
		  $.each(record, function(key, value)
            {
           
              if (i == 0)
              {
                var dt = value[1].substring(0,100);
               
                document.getElementsByName("inv_dt")[0].value = value[0];		
 document.getElementsByName("inv_op")[0].value = value[1];		
 document.getElementsByName("inv_all_total")[0].value = value[2];		
 document.getElementsByName("inv_db")[0].value = value[3];		
 document.getElementsByName("inv_note")[0].value = value[4];		
 document.getElementsByName("inv_Quantity")[0].value = value[5];		
 document.getElementsByName("inv_total")[0].value = value[6];		
 document.getElementsByName("inv_note2")[0].value = value[6];		
 document.getElementsByName("inv_Quantity2")[0].value = value[8];		
 document.getElementsByName("inv_total2")[0].value = value[9];		
 document.getElementsByName("inv_note2	").value = value[10];
 document.getElementsByName("inv_Quantity2	").value = value[11];
 document.getElementsByName("inv_total2	").value = value[12];
 document.getElementsByName("inv_note3	").value = value[13];
 document.getElementsByName("inv_Quantity3	").value = value[14];
 document.getElementsByName("inv_total3	").value = value[15];
 document.getElementsByName("inv_note4	").value = value[16];
 document.getElementsByName("inv_Quantity4	").value = value[17];
 document.getElementsByName("inv_total4	").value = value[18];
 document.getElementsByName("inv_note5	").value = value[19];
 document.getElementsByName("inv_Quantity5	").value = value[20];
 document.getElementsByName("inv_total5	").value = value[21];
 document.getElementsByName("inv_note6	").value = value[22];
 document.getElementsByName("inv_Quantity6	").value = value[23];
 document.getElementsByName("inv_total6	").value = value[24];
 document.getElementsByName("inv_note7	").value = value[025];
 document.getElementsByName("inv_Quantity7	").value = value[26];
 document.getElementsByName("inv_total7	").value = value[27];
 document.getElementsByName("inv_note8	").value = value[28];
 document.getElementsByName("inv_Quantity8	").value = value[29];
 document.getElementsByName("inv_total8	").value = value[30];
 document.getElementsByName("inv_note9	").value = value[31];
 document.getElementsByName("inv_Quantity9	").value = value[32];
 document.getElementsByName("inv_total9	").value = value[33];
 document.getElementsByName("inv_note10	").value = value[34];
 document.getElementsByName("inv_Quantity10	").value = value[35];
 document.getElementsByName("inv_total10	").value = value[36];
 document.getElementsByName("inv_note11	").value = value[37];
 document.getElementsByName("inv_Quantity11	").value = value[38];
 document.getElementsByName("inv_total11	").value = value[39];
 document.getElementsByName("inv_note12	").value = value[40];
 document.getElementsByName("inv_Quantity12	").value = value[41];
 document.getElementsByName("inv_total12	").value = value[42];
 document.getElementsByName("inv_note13	").value = value[43];
 document.getElementsByName("inv_Quantity13	").value = value[44];
 document.getElementsByName("inv_total13	").value = value[45];
 document.getElementsByName("inv_note14	").value = value[46];
 document.getElementsByName("inv_Quantity14	").value = value[47];
 document.getElementsByName("inv_total14	").value = value[48];
 document.getElementsByName("inv_note15	").value = value[49];
 document.getElementsByName("inv_Quantity15	").value = value[50];
 document.getElementsByName("inv_total15	").value = value[51];
 document.getElementsByName("inv_note16	").value = value[52];
 document.getElementsByName("inv_Quantity16	").value = value[53];
 document.getElementsByName("inv_total16	").value = value[54];
 document.getElementsByName("inv_note17	").value = value[55];
 document.getElementsByName("inv_Quantity17	").value = value[56];
 document.getElementsByName("inv_total17	").value = value[57];
 document.getElementsByName("inv_note18	").value = value[58];
 document.getElementsByName("inv_Quantity18	").value = value[59];
 document.getElementsByName("inv_total18	").value = value[60];
 document.getElementsByName("inv_note19	").value = value[61];
 document.getElementsByName("inv_Quantity19	").value = value[62];
 document.getElementsByName("inv_total19	").value = value[63];
 document.getElementsByName("inv_note20	").value = value[64];
 document.getElementsByName("inv_Quantity20	").value = value[65];
 document.getElementsByName("inv_total20	").value = value[66];
 document.getElementsByName("inv_note21	").value = value[67];
 document.getElementsByName("inv_Quantity21	").value = value[68];
 document.getElementsByName("inv_total21	").value = value[69];
 document.getElementsByName("inv_note22	").value = value[70];
 document.getElementsByName("inv_Quantity22	").value = value[71];
 document.getElementsByName("inv_total22	").value = value[72];
 document.getElementsByName("inv_note23	").value = value[73];
 document.getElementsByName("inv_Quantity23	").value = value[74];
 document.getElementsByName("inv_total23	").value = value[75];
 document.getElementsByName("inv_note24	").value = value[76];
 document.getElementsByName("inv_Quantity24	").value = value[77];
 document.getElementsByName("inv_total24	").value = value[78];
 document.getElementsByName("inv_note25	").value = value[79];
 document.getElementsByName("inv_Quantity25	").value = value[80];
 document.getElementsByName("inv_total25	").value = value[81];
 document.getElementsByName("inv_note26	").value = value[82];
 document.getElementsByName("inv_Quantity26	").value = value[83];
 document.getElementsByName("inv_total26	").value = value[84];

              }

              i = i + 1;
            });

            GetTotal();
			ReGenSrNo();

          }
        });
           
       
		$('#exampleModal').modal('hide');
		 
}

function ShowAllData()
{
	$(document).ready(function (){
		
		$.getJSON("https://script.google.com/macros/s/AKfycbwY-UFbyCNcAswUy2uBRlxHUjNqUyDlLDA9fwKAOjO-34REUbn6egRmqBtKd4u3NogY/exec",
        function (data) {
	
		var Table="", Rows="", Columns="";
		$.each(data, function(key, value)
		{
			var Invdt="";
			Columns ="";
			i=0;
			$.each(value, function(key1, value1)
			{
				i++;
				if (i ==2) 
				{
					value1 = "" + value1;
					value1 = value1.substring(0, 10);	
				}
				Columns = Columns + '<td>' + value1 + '</td>';
				if (Invdt == "") Invdt = value1;
				
				
			});
			Rows = Rows + '<tr onclick="Search('+Invdt+')">' + Columns + '</tr>';
		});
		
		$("#MyTBody").html(Rows);
		$('#exampleModal').modal('show');
	});	
	});			

}
function getData() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = sheet.getDataRange().getValues();
  return JSON.stringify(data);
}
function displayResults(results) {
        const resultsTd = document.getElementById('results');
        resultsTd.innerHTML = '';
        results.forEach(row => {
          const td = document.createElement('td');
          div.textContent = row.join(', ');
          resultstd.appendChild(td);
        });
      }
